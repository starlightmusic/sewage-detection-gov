<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sewage Complaint System - Government of India</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Public Complaint Submission View -->
    <div id="public-view" class="view-container">
        <div class="public-header">
            <div class="header-logo">
                <div class="emblem">üáÆüá≥</div>
                <div class="header-text">
                    <h1 data-i18n="title">Mayiladuthurai Municipal Corporation</h1>
                    <p data-i18n="subtitle">Citizen Complaint Management System</p>
                </div>
            </div>
            <div class="header-actions">
                <button id="language-toggle" class="language-toggle-btn" onclick="toggleLanguage()">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
                <button class="admin-link-btn" onclick="showAdminLogin()" data-i18n="adminLogin">Admin Login</button>
            </div>
        </div>
        <div class="public-content">
            <div class="complaint-form-container">
                <h2 data-i18n="formTitle">Submit a Sewage Complaint</h2>
                <p class="form-description" data-i18n="formDescription">Report sewage issues in your area. We will track and resolve your complaint promptly.</p>

                <form id="complaint-form">
                    <div class="form-group">
                        <label for="complaint-location" data-i18n="labelLocation">Location *</label>
                        <input type="text" id="complaint-location" data-i18n-placeholder="placeholderLocation" placeholder="Enter street address or area name" required>
                    </div>

                    <div class="form-group">
                        <label for="complaint-description" data-i18n="labelDescription">Description *</label>
                        <textarea id="complaint-description" rows="4" data-i18n-placeholder="placeholderDescription" placeholder="Describe the sewage issue..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="complaint-contact" data-i18n="labelContact">Contact Number *</label>
                        <input type="tel" id="complaint-contact" data-i18n-placeholder="placeholderContact" placeholder="Your phone number" required>
                    </div>

                    <div class="form-group">
                        <label data-i18n="labelPhoto">Upload Photo of the Issue *</label>
                        <div class="upload-box" id="public-upload-box">
                            <div class="upload-icon">üì∑</div>
                            <p data-i18n="uploadText">Click to upload or drag and drop</p>
                            <p class="upload-hint" data-i18n="uploadHint">JPG, PNG up to 10MB</p>
                            <input type="file" id="public-image-upload" accept="image/*" style="display: none;" required>
                        </div>
                        <div class="image-preview-box" id="public-image-preview" style="display: none;">
                            <img id="public-preview-img" src="" alt="Preview">
                            <button type="button" class="btn-change-image" onclick="changePublicImage()" data-i18n="changeImage">Change Image</button>
                        </div>
                    </div>

                    <button type="submit" class="btn-submit-complaint" data-i18n="submitButton">Submit Complaint</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Admin Login View -->
    <div id="admin-login-view" class="view-container" style="display: none;">
        <div class="login-container">
            <div class="login-box">
                <div class="login-header">
                    <div class="emblem">üáÆüá≥</div>
                    <h2>Admin Login</h2>
                    <p>Mayiladuthurai Municipal Corporation</p>
                </div>
                <form id="admin-login-form">
                    <div class="form-group">
                        <label for="admin-username">Username</label>
                        <input type="text" id="admin-username" placeholder="Enter username" required>
                    </div>
                    <div class="form-group">
                        <label for="admin-password">Password</label>
                        <input type="password" id="admin-password" placeholder="Enter password" required>
                    </div>
                    <div class="login-hint">
                        Default credentials: username: <strong>admin</strong>, password: <strong>admin123</strong>
                    </div>
                    <button type="submit" class="btn-login">Login</button>
                    <button type="button" class="btn-back" onclick="showPublicView()">Back to Public View</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard View -->
    <div id="admin-dashboard-view" class="view-container" style="display: none;">
        <div class="admin-header">
            <div class="header-logo">
                <div class="emblem">üáÆüá≥</div>
                <div class="header-text">
                    <h1>Mayiladuthurai Municipal Corporation</h1>
                    <p>Citizen Complaint Management System</p>
                </div>
            </div>
            <div class="admin-actions">
                <span class="admin-user">Admin Portal</span>
                <button class="btn-logout" onclick="logout()">Logout</button>
            </div>
        </div>
        <div class="admin-content">
            <div class="admin-stats">
                <div class="stat-card">
                    <div class="stat-number" id="total-complaints">0</div>
                    <div class="stat-label">Total Complaints</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pending-complaints">0</div>
                    <div class="stat-label">Pending</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="processing-complaints">0</div>
                    <div class="stat-label">In Process</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="completed-complaints">0</div>
                    <div class="stat-label">Completed</div>
                </div>
            </div>

            <div class="complaints-section">
                <div class="section-header">
                    <h2>Complaint Registry</h2>
                    <button class="btn-export" onclick="exportComplaintsToCSV()" title="Download all complaints as CSV">
                        üì• Export to CSV
                    </button>
                </div>
                <div class="complaints-table">
                    <div class="table-header">
                        <div class="col-id">ID</div>
                        <div class="col-location">Location</div>
                        <div class="col-description">Description</div>
                        <div class="col-contact">Contact</div>
                        <div class="col-status">Status</div>
                        <div class="col-assigned">Assigned To</div>
                        <div class="col-action">Action</div>
                    </div>
                    <div class="table-body" id="complaints-list">
                        <div class="no-complaints">No complaints registered yet</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal-overlay" id="success-modal">
        <div class="modal-content success-modal-content">
            <div class="success-icon">‚úì</div>
            <h2 data-i18n="successTitle">Complaint Submitted Successfully!</h2>
            <p><span data-i18n="successMessage">Your complaint has been registered with ID:</span> <strong id="complaint-id-display"></strong></p>
            <p data-i18n="successInfo">We will track your complaint and notify you once it is resolved.</p>
            <button class="btn-ok" onclick="closeSuccessModal()" data-i18n="okButton">OK</button>
        </div>
    </div>

    <!-- Assign Officer Modal -->
    <div class="modal-overlay" id="assign-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Assign Officer</h2>
                <button class="modal-close" onclick="closeAssignModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="officer-select">Select Officer</label>
                    <select id="officer-select" class="officer-select">
                        <option value="">Choose an officer...</option>
                        <option value="Sanitation Officer Ravi Kumar">Sanitation Officer Ravi Kumar</option>
                        <option value="Field Officer Priya Sharma">Field Officer Priya Sharma</option>
                        <option value="Maintenance Officer Anil Reddy">Maintenance Officer Anil Reddy</option>
                        <option value="Senior Officer Lakshmi Nair">Senior Officer Lakshmi Nair</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeAssignModal()">Cancel</button>
                <button class="btn-submit" onclick="confirmAssignment()">Assign Officer</button>
            </div>
        </div>
    </div>

    <!-- Completion Modal -->
    <div class="modal-overlay" id="completion-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Mark Complaint as Completed</h2>
                <button class="modal-close" onclick="closeCompletionModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p>Please upload a photo showing the resolved issue (after the work is completed).</p>

                <div class="upload-area" id="upload-area">
                    <div class="upload-icon">üì∑</div>
                    <p>Click to upload or drag and drop</p>
                    <p class="upload-hint">Upload a photo of the cleaned location</p>
                    <input type="file" id="completion-image-upload" accept="image/*" style="display: none;">
                </div>

                <div class="image-preview" id="completion-image-preview" style="display: none;">
                    <img id="completion-preview-img" src="" alt="Preview">
                    <button class="btn-change-image" onclick="changeCompletionImage()">Change Image</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeCompletionModal()">Cancel</button>
                <button class="btn-submit" id="btn-submit-completion" onclick="submitCompletion()" disabled>Mark as Completed</button>
            </div>
        </div>
    </div>

    <!-- View Complaint Details Modal -->
    <div class="modal-overlay" id="view-complaint-modal">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h2>Complaint Details</h2>
                <button class="modal-close" onclick="closeViewModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div id="complaint-details-content"></div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeViewModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay" id="delete-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ö†Ô∏è Delete Complaint</h2>
                <button class="modal-close" onclick="closeDeleteModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="warning-message">
                    <p><strong>Warning:</strong> This complaint will be permanently deleted and cannot be recovered.</p>
                    <p>Are you sure you want to proceed?</p>
                    <div id="delete-complaint-info" class="delete-info"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeDeleteModal()">Cancel</button>
                <button class="btn-delete-confirm" onclick="confirmDelete()">Delete Permanently</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
